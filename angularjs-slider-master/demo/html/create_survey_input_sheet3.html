<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Survey Creator and Editor</title>
    
    <script src="../js/jsoneditor.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    
  </head>
  <body>
    <h1>Survey Creator and Editor</h1>
    
    <p>This form allows you to take edit or create surveys:</p>
    
    
    <button id='submit'>Submit (console.log)</button>
    <button id='restore'>Restore to Default</button>
    <button id='enable_disable'>Disable/Enable Form</button>
    <span id='valid_indicator'></span>
    
    <div id='editor_holder'></div>
    
    <script>
      // This is the starting value for the editor
      // We will use this to seed the initial editor 
      // and to provide a "Restore to Default" button.
      
      var valueQuestion = [];
      var entered_value = [];
      var starting_value = [
        {
          "Basic Label": "q1",
          "Default Color": "red",
          "Question Prompt": "This is a question?",
          
          valueArray: {                      
              
                name: "Name1",
                action: "nameaction1",
                definition: "definiton1",
                default: true,
                
                synonyms: [{
                        name: "synname1",
                        action: "synaction1",
                        definition: "syndefinition"
   
                    }]
              
            }
        }
      ];
      // Initialize the editor
      var editor = new JSONEditor(document.getElementById('editor_holder'),{
        // Enable fetching schemas via ajax
        ajax: true,
        
        // The schema for the editor
        schema: {
          type: "array",
          title: "Survey Questions",
          items: {
            title: "Question",
            properties: {
              "Question Prompt": {
                type: "string"
              },
              "Default Color": {
                type: "string"
              },
              "Basic Label": {
                type: "string"
              },
              valueArray: {
                  title: "Values",
                  type: "array",

                  
                  items: 
                    {
                      title: "Value",
                      type: "object",
                      properties: {
                        name: {
                          type: "string"
                        },
                        action: {
                          type: "string"
                        },
                        definition: {
                          type: "string"
                        },
                        default: {
                          type: "boolean"
                        },
                        synonyms: {
                          title: "Synonyms",
                          type: "array",

                          items: {
                            title: "synonym",
                            type: "object",
                            properties: {
                                name: {
                                  type: "string"
                                },
                                action: {
                                  type: "string"
                                },
                                definition: {
                                  type: "string"
                                }
                            }
                          }
                        }
                      }
                    }
                }
            }
          }
},

        
        // Seed the form with a starting value
        startval: starting_value,
        
        // Disable additional properties
        no_additional_properties: true,
        
        // Require all properties by default
        required_by_default: true
      });
      


  	var appendToJSONData = function(JSONFile, newJSONData) {
  		console.log(valueQuestion.length, valueQuestion[valueQuestion.length]);
  		questions.json.push({
  			"id":"0001",
	         "Question":"Think of somehing stressful you have done recently or need to do.",
	         "ValueOptions":{
	            "value":[
	               {
	                  "name":"Dread",
	                  "action":"You are Full of Dread",
	                  "definition":"Dry mouth; heart racing; trembling",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Panic",
	                           "action":"You are Panicking"
	                        },
	                        {
	                           "name":"Distressed",
	                           "action":"You are Distressed"
	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Highly Anxious",
	                  "action":"You are Highly Anxious",
	                  "definition":"Worried; afraid; upset",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Fearful",
	                           "action":"You are Fearful"
	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Nervous",
	                  "action":"You are Nervous",
	                  "definition":"Hesitant; concerned; can't perform to potential",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Timid",
	                           "action":"You are Timid"
	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Courageous",
	                  "action":"You are Courageous",
	                  "definition":"Bravery in the face of fear; closed 'GAPS",
	                  "default?":true,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Brave",
	                           "action":"You are Brave"
	                        },
	                        {
	                           "name":"Assertive",
	                           "action":"You are Assertive"
	                        },
	                        {
	                           "name":"Thoughtful",
	                           "action":"You are Thoughtful"
	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Unaware of other's feelings",
	                  "action":"You are Unaware of Other's Feelings",
	                  "definition":"Take over; talk over the top of others; butt in conversations; put down; rude",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {

	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Overconfident",
	                  "action":"You are Overconfident",
	                  "definition":"Opinionated; over-compensate; ego; proud; hasty",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Careless",
	                           "action":"You are Careless"
	                        }
	                     ]
	                  }
	               },
	               {
	                  "name":"Rash",
	                  "action":"You are Rash",
	                  "definition":"Irresponsible; lose control; extremely bold",
	                  "default?":false,
	                  "synonyms":{
	                     "synonym":[
	                        {
	                           "name":"Reckless",
	                           "action":"You are Reckless"
	                        }
	                     ]
	                  }
	               }
	            ]
	         },
	         "defaultColor":"green",
	         "BasicLabel":"Courage",
	         "AnswerValue":"",
	         "href": "#/first",
	         "AnswerKeyWords":""	
	  		});
  	}

      // Hook up the submit button to log to the console
      document.getElementById('submit').addEventListener('click',function() {
        // Get the value from the editor
        entered_value = editor.getValue();
        console.log("Editor empty", editor.getValue());
        console.log("Starting val", starting_value);
        console.log("questions_id", valueQuestion);

      });
      
      // Hook up the Restore to Default button
      document.getElementById('restore').addEventListener('click',function() {
        editor.setValue(starting_value);
      });
      
      // Hook up the enable/disable button
      document.getElementById('enable_disable').addEventListener('click',function() {
        // Enable form
        if(!editor.isEnabled()) {
          editor.enable();
        }
        // Disable form
        else {
          editor.disable();
        }
      });
    
    loadJSON = function() {
	
	var returnJSON = [];
	$.getJSON("../json/questions.json", function(json) {
	  $.each(json.Questions, function(k, v) {
	    // console.log(k, v);
	  })
	  valueQuestion.push(json.Questions);
	  // $scope.valueQuestion = json.Questions[0].Question;
	  // return json;
	});
	// console.log($scope.valueQuestion);   
	}

	loadJSON();

      // Hook up the validation indicator to update its 
      // status whenever the editor changes
      editor.on('change',function() {
        // Get an array of errors from the validator
        var errors = editor.validate();
        
        var indicator = document.getElementById('valid_indicator');
        
        // Not valid
        if(errors.length) {
          indicator.style.color = 'red';
          indicator.textContent = "not valid";
        }
        // Valid
        else {
          indicator.style.color = 'green';
          indicator.textContent = "valid";
        }
      });
    </script>
  </body>
</html>
